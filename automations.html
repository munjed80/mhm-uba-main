<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>UBA Automations</title>
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/enhanced-automations.css" />
  </head>
  <body>
    <section id="uba-dashboard">
      <div id="page-id" data-page="automations-page">
        <div class="uba-shell">
          <aside class="uba-sidebar">
            <div>
              <div class="uba-logo">MHM <span>UBA</span></div>
              <p class="uba-tagline" data-i18n="app.tagline">
                Universal Business Automator ‚Äî one workspace for clients, tasks,
                invoices and smart tools.
              </p>
              <div class="uba-badge">
                <span class="uba-badge-dot"></span
                ><span data-i18n="app.badge">
                  Private beta ¬∑ Built in the Netherlands
                </span>
              </div>
            </div>

            <div class="uba-language">
              <label for="language-select" data-i18n="language.label"
                >Language</label
              >
              <select id="language-select">
                <option value="en" data-i18n="language.en">English</option>
                <option value="ar" data-i18n="language.ar">Arabic</option>
                <option value="nl" data-i18n="language.nl">Dutch</option>
                <option value="fr" data-i18n="language.fr">French</option>
                <option value="es" data-i18n="language.es">Spanish</option>
                <option value="de" data-i18n="language.de">German</option>
              </select>
            </div>

            <div>
              <div class="uba-nav-label" data-i18n="nav.workspaceLabel">
                Workspace
              </div>
              <nav class="uba-nav">
                <a class="uba-nav-btn" href="index.html"
                  ><span class="icon">üìà</span>
                  <span data-i18n="nav.dashboard">Dashboard</span>
                  <small data-i18n="nav.dashboardSub">Overview</small></a
                >
                <a class="uba-nav-btn" href="clients.html"
                  ><span class="icon">üßë‚Äçüíª</span>
                  <span data-i18n="nav.clients">Clients</span>
                  <small data-i18n="nav.clientsSub">CRM</small></a
                >
                <a class="uba-nav-btn" href="projects.html"
                  ><span class="icon">üíº</span>
                  <span data-i18n="nav.projects">Projects</span>
                  <small data-i18n="nav.projectsSub">Pipeline</small></a
                >
                <a class="uba-nav-btn" href="tasks.html"
                  ><span class="icon">‚úÖ</span>
                  <span data-i18n="nav.tasks">Tasks</span>
                  <small data-i18n="nav.tasksSub">Today</small></a
                >
                <a class="uba-nav-btn" href="invoices.html"
                  ><span class="icon">üíµ</span>
                  <span data-i18n="nav.invoices">Invoices</span>
                  <small data-i18n="nav.invoicesSub">Billing</small></a
                >
                <a class="uba-nav-btn active" href="automations.html"
                  ><span class="icon">ü§ñ</span>
                  <span data-i18n="nav.automations">Automations</span>
                  <small data-i18n="nav.automationsSub">Flows</small></a
                >
                <a class="uba-nav-btn" href="calendar.html"
                  ><span class="icon">üìÖ</span><span>Calendar</span></a
                >
                <a class="uba-nav-btn" href="leads.html"
                  ><span class="icon">üß≤</span><span>Leads</span></a
                >
                <a class="uba-nav-btn" href="expenses.html"
                  ><span class="icon">üì§</span><span>Expenses</span></a
                >
                <a class="uba-nav-btn" href="files.html"
                  ><span class="icon">üìÅ</span><span>Files</span></a
                >
                <a class="uba-nav-btn" href="reports.html"
                  ><span class="icon">üìë</span><span>Reports</span></a
                >
                <a class="uba-nav-btn" href="smart-tools.html"
                  ><span class="icon">üß†</span>
                  <span data-i18n="nav.smartTools">UBA Smart Tools</span>
                  <small data-i18n="nav.smartToolsSub">AI ops</small></a
                >
                <a class="uba-nav-btn" href="insights.html"
                  ><span class="icon">üìä</span>
                  <span data-i18n="nav.insights">Insights Lab</span>
                  <small data-i18n="nav.insightsSub">Reports</small></a
                >
                <a class="uba-nav-btn" href="help.html"
                  ><span class="icon">üí¨</span>
                  <span data-i18n="nav.support">Success Desk</span>
                  <small data-i18n="nav.supportSub">Guidance</small></a
                >
                <a class="uba-nav-btn" href="settings.html"
                  ><span class="icon">üõ†Ô∏è</span>
                  <span data-i18n="nav.settings">Settings</span>
                  <small data-i18n="nav.settingsSub">Workspace</small></a
                >
              </nav>
            </div>

            <div class="uba-sidebar-footer" data-i18n="sidebar.footer">
              Designed for small teams and solo founders who are tired of 7
              different tools just to run one business.
            </div>
          </aside>

          <main class="uba-main">
            <header class="uba-topbar">
              <div class="uba-top-left">
                <p class="uba-top-kicker">Automation</p>
                <h1 id="uba-view-title" data-i18n="view.automations.title">
                  Automations
                </h1>
                <p id="uba-view-desc" data-i18n="view.automations.desc">
                  Overview of flows with sample activity logs.
                </p>
              </div>
              <div class="uba-top-right">
                <select id="workspace-select" class="uba-select">
                  <option>Main workspace</option>
                </select>
                <div class="uba-user-pill">
                  <span class="uba-avatar"></span
                  ><span id="uba-user-label">Admin</span>
                </div>
              </div>
            </header>

            <div class="uba-views">
              <section class="uba-view" data-view="automations">
                <div class="automation-hero-surface">
                  <div class="automation-hero">
                    <div class="automation-hero-content">
                      <p class="hero-eyebrow">Automation Control Center</p>
                      <h2>Orchestrate every client, finance, and ops workflow</h2>
                      <p>
                        Launch dependable automations that watch your CRM, billing, and delivery data
                        in real time. Every rule is fully auditable, uses safe defaults, and can be
                        extended with advanced triggers or outbound actions.
                      </p>
                      <div class="automation-hero-actions">
                        <button
                          id="new-automation-btn"
                          class="uba-btn uba-btn-primary uba-btn-lg"
                          type="button"
                        >
                          <span class="icon">‚ö°</span>
                          <span>Launch Automation Builder</span>
                        </button>
                        <button class="uba-btn uba-btn-ghost uba-btn-lg" type="button">
                          <span class="icon">üìö</span>
                          <span>Browse playbooks</span>
                        </button>
                      </div>
                      <ul class="automation-promise-list">
                        <li>Real triggers mapped to tasks, invoices, leads, and projects</li>
                        <li>Multiple actions per rule with validation and safe rollbacks</li>
                        <li>Centralized audit log with export-ready history</li>
                      </ul>
                    </div>
                    <div class="automation-hero-panel" aria-label="Automation activity overview">
                      <div class="hero-panel-header">
                        <span>Latest orchestration</span>
                        <span class="status-live">Live</span>
                      </div>
                      <div class="hero-panel-body">
                        <div class="hero-flow-step">
                          <span>Trigger</span>
                          <strong>Invoice Due &middot; Enterprise Retainer</strong>
                          <small>Queued 2 min ago</small>
                        </div>
                        <div class="hero-flow-step">
                          <span>Condition</span>
                          <strong>Amount &gt; 5,000 ¬∑ Client tagged VIP</strong>
                          <small>Ruleset matched</small>
                        </div>
                        <div class="hero-flow-step">
                          <span>Actions</span>
                          <strong>Task + Slack notification + Ledger note</strong>
                          <small>Executed in 420ms</small>
                        </div>
                      </div>
                      <div class="hero-panel-footer">
                        <span>Next review</span>
                        <strong>Weekly automation audit ¬∑ Friday 09:00</strong>
                      </div>
                    </div>
                  </div>

                  <div class="automation-hero-metrics">
                    <div class="hero-metric">
                      <p>Active automations</p>
                      <strong id="automation-count">0</strong>
                      <small>Live safeguards</small>
                    </div>
                    <div class="hero-metric">
                      <p>Total runs</p>
                      <strong id="automation-runs">0</strong>
                      <small>Last 30 days</small>
                    </div>
                    <div class="hero-metric">
                      <p>On-time routing</p>
                      <strong>99.4%</strong>
                      <small>Measured across all flows</small>
                    </div>
                    <div class="hero-metric">
                      <p>Blueprints ready</p>
                      <strong>24</strong>
                      <small>Prebuilt client journeys</small>
                    </div>
                  </div>
                </div>

                <section id="automations-page" class="automation-core">
                  <div class="automation-panels">
                    <article class="automation-panel automation-command-center">
                      <div class="automation-panel-header">
                        <div>
                          <p class="eyebrow">Command panel</p>
                          <h3>Build dependable flows in minutes</h3>
                          <p>
                            Define structured triggers, stack unlimited actions, and set guardrails for
                            data updates or external notifications. Everything you configure is versioned
                            and can be tested against sandbox data before going live.
                          </p>
                        </div>
                      </div>
                      <ul class="automation-checklist">
                        <li>
                          <span class="icon">üéØ</span>
                          <div>
                            <strong>Precise trigger conditions</strong>
                            <small>Filter on priority, monetary thresholds, project stages, or custom fields.</small>
                          </div>
                        </li>
                        <li>
                          <span class="icon">üß©</span>
                          <div>
                            <strong>Composable action stack</strong>
                            <small>Mix tasks, notifications, updates, and webhooks per rule.</small>
                          </div>
                        </li>
                        <li>
                          <span class="icon">üõ°Ô∏è</span>
                          <div>
                            <strong>Safety controls</strong>
                            <small>Enable approvals, dry-runs, and automatic throttling.</small>
                          </div>
                        </li>
                      </ul>
                      <div class="automation-command-footer">
                        <button class="uba-btn uba-btn-secondary" type="button">
                          Preview sandbox data
                        </button>
                        <button class="uba-btn uba-btn-ghost" type="button">
                          View change history
                        </button>
                      </div>
                    </article>

                    <article class="automation-panel automation-signal-card">
                      <header>
                        <p class="eyebrow">Signal board</p>
                        <h3>Real-time guardrails</h3>
                        <p>Monitor execution health, failure retries, and approvals waiting on you.</p>
                      </header>
                      <ul class="signal-grid">
                        <li>
                          <span>Pending approvals</span>
                          <strong>3</strong>
                          <small>Finance follow-ups awaiting sign-off</small>
                        </li>
                        <li>
                          <span>Retries scheduled</span>
                          <strong>1</strong>
                          <small>Webhook endpoint slowed down</small>
                        </li>
                        <li>
                          <span>Muted rules</span>
                          <strong>2</strong>
                          <small>Paused during pricing experiment</small>
                        </li>
                        <li>
                          <span>Success streak</span>
                          <strong>47</strong>
                          <small>Runs without manual intervention</small>
                        </li>
                      </ul>
                    </article>
                  </div>

                  <section class="automation-data-card" aria-labelledby="automation-table-title">
                    <div class="automation-data-card-header">
                      <div>
                        <p class="eyebrow">Automation library</p>
                        <h3 id="automation-table-title">Active and draft automations</h3>
                        <p>Every rule shows its trigger, action stack, health, and last execution time.</p>
                      </div>
                    </div>
                    <div class="uba-table-wrap">
                      <table class="uba-table enhanced-automations-table">
                        <thead>
                          <tr>
                            <th>Name</th>
                            <th>Trigger</th>
                            <th>Actions</th>
                            <th>Status</th>
                            <th>Last run</th>
                            <th style="width: 140px">Controls</th>
                          </tr>
                        </thead>
                        <tbody id="automations-body">
                          <tr>
                            <td colspan="6">
                              No automations yet. Create your first rule.
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </section>

                  <section class="automation-data-card" aria-labelledby="automation-log-title">
                    <div class="automation-data-card-header">
                      <div>
                        <p class="eyebrow">Operational telemetry</p>
                        <h3 id="automation-log-title">Execution log</h3>
                        <p>Chronological record of rule runs, payload summaries, and success signals.</p>
                      </div>
                      <button id="clear-logs-btn" class="uba-btn-ghost" type="button">
                        Clear logs
                      </button>
                    </div>
                    <div class="uba-table-wrap">
                      <table class="uba-table">
                        <thead>
                          <tr>
                            <th>Rule</th>
                            <th>Trigger</th>
                            <th>Result</th>
                            <th>Details</th>
                            <th>Timestamp</th>
                          </tr>
                        </thead>
                        <tbody id="automation-logs-body">
                          <tr>
                            <td colspan="5">No automation runs yet.</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </section>

                  <section class="automation-catalog">
                    <article>
                      <p class="eyebrow">Trigger catalog</p>
                      <h3>Events you can listen to</h3>
                      <p>
                        Mix and match granular filters to decide when each automation fires. Every trigger
                        supports optional constraints so you never spam your teams.
                      </p>
                      <ul class="catalog-list">
                        <li><strong>Task Created</strong> &middot; react instantly when work is scheduled.</li>
                        <li><strong>Invoice Due</strong> &middot; escalate billing risk before it grows.</li>
                        <li><strong>Lead Updated</strong> &middot; sync follow-up cadences with sales.</li>
                        <li><strong>Project Stage Changed</strong> &middot; align stakeholders as work moves.</li>
                        <li><strong>Client Created</strong> &middot; onboard consistently every time.</li>
                        <li><strong>Deadline Approaching</strong> &middot; remind the right owner ahead of time.</li>
                      </ul>
                    </article>
                    <article>
                      <p class="eyebrow">Action catalog</p>
                      <h3>Responses you can stack</h3>
                      <p>
                        Combine unlimited actions per rule to keep clients informed, teams aligned, and
                        systems in sync.
                      </p>
                      <ul class="catalog-list">
                        <li><strong>Send Notification</strong> to inboxes or in-app alerts.</li>
                        <li><strong>Create Task</strong> with prefilled context and deadlines.</li>
                        <li><strong>Add Log Entry</strong> for your compliance or success teams.</li>
                        <li><strong>Update Record</strong> fields when data requirements change.</li>
                        <li><strong>Send Email</strong> using branded templates.</li>
                        <li><strong>Webhook</strong> any payload to external platforms.</li>
                      </ul>
                    </article>
                  </section>
                </section>
              </section>
            </div>

            <!-- Enhanced Automation Modal will be dynamically injected by JavaScript -->
          </main>
        </div>
      </div>
    </section>

    
    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Supabase Config (if exists) -->
    <script>
      // Try to load config, fail silently if not found
      const script = document.createElement('script');
      script.src = 'supabase-config.js';
      script.onerror = () => console.warn('[Auth] supabase-config.js not found - running in local/demo mode');
      document.head.appendChild(script);
    </script>
    
    <!-- Supabase API Service -->
    <script src="assets/js/supabase-api-service.js"></script>
    
    <!-- Auth Guard (protect this page) -->
    <script src="assets/js/auth-guard.js"></script>
    
    <script src="assets/js/i18n.js"></script>
    <script src="assets/js/store.js"></script>
    <script src="assets/js/data-layer.js"></script>
    <script src="assets/js/validation.js"></script>
    <script src="assets/js/app.js"></script>
    <script src="assets/js/page-loader.js"></script>
    <script src="assets/js/automations.js"></script>
    <script src="assets/js/enhanced-automations.js"></script>
    <script src="assets/js/enhanced-automations-ui.js"></script>
  </body>
</html>
